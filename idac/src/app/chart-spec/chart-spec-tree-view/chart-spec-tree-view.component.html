<div class="container-fluid p-0">
  <section class="d-flex">
    <div (click)="_currentTagChange(tag)" class="w-100  border {{ tag === currentTag ? 'border-primary highlight' : 'bg-light' }}">
      <div class="d-flex justify-content-between">
        <div class="d-flex">
          <p class="font-weight-light">
            <span class="text-danger"
              (mouseover)="tag.editorsNote.showInGraphView = true"
              (mouseout)="tag.editorsNote.showInGraphView = false">{{ tag.editorsNote.active ? 'üìù' : '' }}</span>
            <span>{{ tag._tagname }}{{isCollapsed === false ? '[' + (siblingIndex + 1) + ']' : ''}}</span>
          </p>
          <p class="font-weight-normal ml-2">{{ tag.describe() }}</p>
        </div>
        <p *ngIf="tag === currentTag" (click)="_editChange(!edit)" style="cursor: pointer" class="text-secondary">{{ edit ? 'Done' : 'Edit' }}</p>
      </div>
      <div *ngIf="edit && tag === currentTag">
        <div class="d-flex justify-content-end">
          <p (click)="editPanel = 'override'" style="cursor: pointer" class="text-secondary mx-1">Override</p>
          <p (click)="editPanel = 'template'" style="cursor: pointer" class="text-secondary mx-1">Template</p>
          <!--p (click)="editPanel = 'attributes'" style="cursor: pointer" class="text-secondary mx-1">Attributes</p-->
        </div>
        <app-description-panel *ngIf="editPanel === 'template'" [tag]="tag"></app-description-panel>
        <app-properties-panel *ngIf="editPanel === 'template'" [tag]="tag"></app-properties-panel>
        <app-editors-note-panel *ngIf="editPanel === 'override'" [tag]="tag"></app-editors-note-panel>
        <app-attributes-panel *ngIf="editPanel === 'attributes'" [tag]="tag"></app-attributes-panel>
      </div>
    </div>
    <div *ngIf="isCollapsed === false">
      <p (click)="decrease()" style="cursor: pointer" class="text-secondary">‚ñ≤</p>
      <p (click)="increase()" style="cursor: pointer" class="text-secondary">‚ñº</p>
    </div>
  </section>
  <div class="d-flex" *ngIf="tag.children">
    <span *ngIf="true || collapsable" (click)="collapseChildren=!collapseChildren; _currentTagChange(tag.children[0])"
      style="width: 30px; cursor: pointer" class="badge badge-light my-2 indent-{{indent}} {{collapsable ? '' : 'invisible'}}">
      {{ collapseChildren ? '„Ö°' : tag.children.length }}
    </span>
    <div class="w-100">
      <div *ngFor="let childTag of tag.children; index as i">
        <app-chart-spec-tree-view
          class="{{ !collapsable || collapseChildren || i === collapseIndex ? '' : 'd-none'}}"
          [(edit)]="edit"
          [tag]="childTag" [isCollapsed]="!collapsable || collapseChildren"
          [siblingIndex]="i" [siblingLength]="tag.children.length" [(parentCollapseIndex)]="collapseIndex"
          [currentTag]="currentTag" (currentTagChange)="_currentTagChange($event)" [indent]="indent + 1"></app-chart-spec-tree-view>
      </div>
    </div>
  <div>
</div>
